/*! flickr-feed 26-11-2015 */
var app=angular.module("myApp",["infinite-scroll"]),url="http://api.flickr.com/services/feeds/photos_public.gne?tags=potato&tagmode=all&format=json&jsoncallback=JSON_CALLBACK",addToArray=function(a,b,c){for(var d=0;c>d&&d<a.length;d++)b.push(a.pop())};app.controller("postsCtrl",function(a,b){b.jsonp(url).success(function(b){var c=[],d=[];a.posts=d;var e=function(a){return new Date(a.published)},f=b.items.sort(function(a,b){return e(a)-e(b)});f.map(function(a){var b=document.createElement("div");b.innerHTML=a.description;var d={};d.published_date=moment(e(a)).format("Do MMM YYYY [at] HH:mm"),d.title=a.title,d.link=a.link,d.pic=a.media.m,d.author=a.author,d.photo_author=b.getElementsByTagName("a")[0].innerHTML,d.photo_title=b.getElementsByTagName("a")[1].getAttribute("title"),d.tags=a.tags.split(" "),d.author_link=b.getElementsByTagName("a")[0].getAttribute("href"),c.push(d)}),addToArray(c,d,10),a.loadMore=function(){addToArray(c,d,2)},a.showDetail=function(b){a.detail=b,document.getElementById("post-list").style.display="none",document.getElementById("post-details").style.display="block"},a.showList=function(){document.getElementById("post-list").style.display="block",document.getElementById("post-details").style.display="none"}})});var mod;mod=angular.module("infinite-scroll",[]),mod.directive("infiniteScroll",["$rootScope","$window","$timeout",function(a,b,c){return{link:function(d,e,f){var g,h,i,j;b=angular.element(b),i=0,null!=f.infiniteScrollDistance&&d.$watch(f.infiniteScrollDistance,function(a){return i=parseInt(a,10)}),j=!0,g=!1,null!=f.infiniteScrollDisabled&&d.$watch(f.infiniteScrollDisabled,function(a){return j=!a,j&&g?(g=!1,h()):void 0});var k=0,l=-1;return h=function(){var c=$(this).scrollTop(),h=!1;if(c>k&&(h=!0),k=c,h&&!((new Date).getTime()-l<400)){var m,n,o,p;return p=b.height()+b.scrollTop(),m=e.offset().top+e.height(),n=m-p,o=n<=b.height()*i,o&&j?(l=(new Date).getTime(),a.$$phase?d.$eval(f.infiniteScroll):d.$apply(f.infiniteScroll)):o?g=!0:void 0}},b.on("scroll",h),d.$on("$destroy",function(){return b.off("scroll",h)}),c(function(){return f.infiniteScrollImmediateCheck?d.$eval(f.infiniteScrollImmediateCheck)?h():void 0:h()},0)}}}]);